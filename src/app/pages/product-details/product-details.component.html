<div class="product--single">
  <div class="container-top">
    <div class="top--nav">
      <ul>
        <li>Trang chủ </li>
        <li> / Sản phẩm</li>
      </ul>
    </div>
    <!-- Thông tin chi tiết -->

    <div class="container container--medium">
      <div class="product--single__wrapper" *ngIf="product">
        <div class="product--single__images">
          <div *ngFor="let image of product.images; let i = index">
            <div class="none" [ngClass]="{'isActive': isActive === i}">
              <div class="product--img">
                <img src="{{image.imgUrl}}" alt="Ảnh" width="740" height="1090" *ngIf="!imgBindding">
                <img src="{{imgBindding}}">
              </div>
              <div class="product--option">
                <div class="product--option__item" *ngFor="let item of product.images; let i = index"
                  [ngClass]="{'is-current': isCurrent === i}" (click)="chooseImgItem(i,item.imgUrl)">
                  <img src="{{item.imgUrl}}" alt="Ảnh">
                </div>
              </div>
            </div>
            <span class="previous" [ngClass]="{'isActive': isActive === i}"></span>
            <span class="next" [ngClass]="{'isActive': isActive === i}"></span>
          </div>
        </div>

        <div class="product--single__details">
          <h1 class="product--single__title">{{product.productName}}</h1>
          <div class="product--single__review" *ngIf="ListReview.length == 0">Chưa có đánh giá!</div>
          <div class="product--single__review" *ngIf="ListReview.length > 0"> Đã bán (web): {{ListReview.length}}</div>
          <div class="product--single__price">{{product.price | FormatVndPipe}}</div>
          <div class="product--single__addToCart">
            <div class="product--single__option">
              <div class="option__item">
                <div class="option--title">Màu sắc: <span style="font-weight: bold;">{{colorConvert}}</span></div>
                <div class="option--select">
                  <label class="option--select__item" *ngFor="let color of product.colors; let i = index">
                    <input type="radio" name="color" value="{{product.colors[i].colorText}}">
                    <span class="checkmark " [ngClass]="{'is-active': selectedIndex === i}"
                      style="margin-right:16px;background-image: url('{{product.colors[i].colorImg}}')"
                      (click)="selectedColor(i)">
                    </span>
                  </label>
                </div>
                <div class="guide--user" [ngClass]="{'is-error':hasError}">
                  <div class="option--heading">
                    <span>Kích thước:
                      <span type="text" style="font-weight: bold;">{{size}}</span>
                    </span>
                    <!-- Nút để mở modal -->
<span style="color: #2f5acf; cursor: pointer;" (click)="openSizeGuide()">Hướng dẫn chọn size</span>

<!-- Modal -->
<div class="modal-overlay" *ngIf="showSizeModal">
  <div class="modal-content">
    <button class="close-btn" (click)="closeSizeGuide()">×</button>
    <!-- Nội dung bảng thông số bạn đã gửi -->
    <div class="py-4">
      <div class="mt-4">
        <div class="mb-2 text-base font-bold uppercase">Thông số sản phẩm</div>
        <!-- ...dán toàn bộ nội dung bảng size của bạn ở đây -->
         <div class="py-4"><div class="mt-4"><div class="mb-2 text-base font-bold uppercase">Thông số sản phẩm</div><div class="overflow-x-auto"><div class="relative overflow-x-auto"><table class="relative w-full border border-neutral-200 font-criteria"><thead><tr class="border-b border-neutral-200 bg-light"><th class="sticky left-0 z-10 bg-light p-2 text-sm font-bold leading-5 text-neutral-800 min-w-32 text-start">Size</th><th class="p-2 text-center text-sm font-bold leading-5 text-neutral-800 min-w-24">S</th><th class="p-2 text-center text-sm font-bold leading-5 text-neutral-800 min-w-24">M</th><th class="p-2 text-center text-sm font-bold leading-5 text-neutral-800 min-w-24">L</th><th class="p-2 text-center text-sm font-bold leading-5 text-neutral-800 min-w-24">XL</th><th class="p-2 text-center text-sm font-bold leading-5 text-neutral-800 min-w-24">2XL</th><th class="p-2 text-center text-sm font-bold leading-5 text-neutral-800 min-w-24">3XL</th></tr></thead><tbody><tr class="border-b border-b-neutral-200 bg-neutral-100"><td class="sticky left-0 z-10 whitespace-pre-wrap p-2 text-sm font-bold text-neutral-800 bg-neutral-100 min-w-32 text-start">Chiều cao</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">1m55 - 1m59</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">1m69 - 1m65</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">1m66 - 1m72</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">1m72 - 1m77</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">1m77 - 1m83</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">1m83 - 1m89</td></tr><tr class="border-b border-b-neutral-200 bg-light"><td class="sticky left-0 z-10 whitespace-pre-wrap p-2 text-sm font-bold text-neutral-800 bg-light min-w-32 text-start">Cân nặng</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">48kg - 54kg</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">55kg - 61kg</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">62kg - 68kg</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">69kg - 75kg</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">76kg - 82kg</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">85kg - 90kg</td></tr><tr class="border-b border-b-neutral-200 bg-neutral-100"><td class="sticky left-0 z-10 whitespace-pre-wrap p-2 text-sm font-bold text-neutral-800 bg-neutral-100 min-w-32 text-start">Dài áo</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">66</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">67</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">69</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">71</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">73</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">75</td></tr><tr class="border-b border-b-neutral-200 bg-light"><td class="sticky left-0 z-10 whitespace-pre-wrap p-2 text-sm font-bold text-neutral-800 bg-light min-w-32 text-start">1/2 Ngang ngực</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">47</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">49</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">51</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">53</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">55</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">57</td></tr><tr class="border-b border-b-neutral-200 bg-neutral-100"><td class="sticky left-0 z-10 whitespace-pre-wrap p-2 text-sm font-bold text-neutral-800 bg-neutral-100 min-w-32 text-start">Dài tay</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">35</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">36.5</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">38</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">39.5</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">41</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">42.5</td></tr><tr class="border-b border-b-neutral-200 bg-light"><td class="sticky left-0 z-10 whitespace-pre-wrap p-2 text-sm font-bold text-neutral-800 bg-light min-w-32 text-start">Rộng bắp tay</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">19.6</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">20.4</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">21.2</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">22</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">22.8</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">23.6</td></tr><tr class="border-b border-b-neutral-200 bg-neutral-100"><td class="sticky left-0 z-10 whitespace-pre-wrap p-2 text-sm font-bold text-neutral-800 bg-neutral-100 min-w-32 text-start">Rộng cửa tay</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">16</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">16.5</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">17</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">17.5</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">18</td><td class="p-2 text-center font-sans text-sm text-neutral-700 hover:bg-neutral-200 hover:text-primary">18.5</td></tr></tbody></table></div></div></div><div class="mt-4 rounded bg-neutral-200 px-4 py-3 font-sans text-sm leading-4.5 text-neutral-800/90"><p class="font-bold">Trường hợp số đo của bạn nằm trong khoảng giữa các size với nhau:</p><ul class="list-disc pl-4"><li>Với áo thun, bạn hãy lựa chọn ưu tiên theo chiều cao</li><li>Ví dụ chiều cao của bạn theo size L nhưng cân nặng của bạn theo size M, hãy chọn L.</li><li>97% khách hàng của chúng tôi đã chọn đúng size theo cách này.</li></ul></div></div>
      </div>
    </div>
  </div>
</div>

                  </div>
                  <div class="choose--size">
                    <label class="choose--size__item" *ngFor="let size of product.sizes; let i = index">
                      <input type="radio" name="size" [disabled]="size.quantityAvalible === 0" value="{{size.sizeText}}" (click)="setSize(i,$event)">
                      <span class="checkmark"
                      [ngClass]="{'is-choose': isChoose === i,'is-disabled':size.quantityAvalible === 0}"

                      >{{size.sizeText}}</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <div class="product--single__action">
              <div class="product--single__quality">
                <a style="cursor: pointer;" class="quantity__reduce" (click)="countSub()">-</a>
                <input type="number" value="1" max="99" min="1" class="quantity__control" [(ngModel)]="count">
                <a style="cursor: pointer;" class="quantity__augure" (click)="countAdd()">+</a>
              </div>
              <div class="product-single__button">
                <a class="btnCustom">
                  <p *ngIf="!result" (click)="showError()">Chọn kích thước</p>
                  <p *ngIf="result" (click)="addToCart(product)">Thêm vào giỏ hàng</p>
                </a>
              </div>
            </div>
          </div>
          <div class="product-single__policy">
            <div class="product-policy">
              <div class="product-policy__item">
                <div class="product-policy__icon"><img src="https://www.coolmate.me/images/icons/icon3.svg"
                    alt="Đổi trả với số điện thoại"></div> <span class="product-policy__title">
                  Đổi trả cực dễ<br> chỉ cần số điện thoại
                </span>
              </div>
              <div class="product-policy__item">
                <div class="product-policy__icon"><img src="https://www.coolmate.me/images/icons/icon4.svg"
                    alt="Miễn phí vận chuyển"></div> <span class="product-policy__title">
                  Miễn phí vận chuyển<br> cho đơn hàng trên 200k
                </span>
              </div>
              <div class="product-policy__item">
                <div class="product-policy__icon"><img src="https://www.coolmate.me/images/icons/icon5.svg"
                    alt="Đổi hàng trong 60 ngày"></div> <span class="product-policy__title">
                  60 ngày đổi trả<br> vì bất kỳ lý do gì
                </span>
              </div>
              <div class="product-policy__item">
                <div class="product-policy__icon"><img src="https://www.coolmate.me/images/icons/icon2.svg"
                    alt="Hotline 1900.27.27.37" style="width: 25px;"></div> <span class="product-policy__title">
                  Hotline 1900.27.27.37 <br>
                  hỗ trợ từ 8h30 - 22h mỗi ngày
                </span>
              </div>
              <div class="product-policy__item">
                <div class="product-policy__icon"><img src="https://www.coolmate.me/images/icons/icon1.svg"
                    alt="Trả hàng tận nơi"></div> <span class="product-policy__title">
                  Đến tận nơi nhận hàng trả,<br> hoàn tiền trong 24h
                </span>
              </div>
              <div class="product-policy__item">
                <div class="product-policy__icon"><img src="https://www.coolmate.me/images/icons/icon6.svg"
                    alt="Giao hàng"></div>
                <span class="product-policy__title">
                  Giao hàng nhanh toàn quốc
                </span>
              </div>
            </div>
          </div>
          <div class="product-single__features">
            <div class="product-features"><a href="#features-listing" class="product-features__heading  is-active "
                >
                Đặc điểm nổi bật
              </a>
              <div id="features-listing" class="product-features__listing" style="display: block">
                <div class="product-features__item">
                  Chất liệu 100% Cotton tạo sự mềm mại ngay lần đầu chạm
                </div>
                <div class="product-features__item">
                  Phù hợp với: đi làm, đi chơi, mặc ở nhà
                </div>
              </div>
            </div>
          </div>
          <div rel-script="product-related" style="padding-top: 15px;" class="product-related">
            <h4 class="product-related__title">
              Sản phẩm bạn có thể thích
            </h4>
            <div
              class="product-related__listings">
              <div class="product-related__item" *ngFor="let productRecommend of listProductRecommendation">
                <div class="product-grid product option-changed">
                  <div class="product-grid__thumbnail not-sale-tag">
                    <div class="product-grid__image">
                      <a
                        href="/product-details/{{productRecommend.id}}">
                        <img loading="lazy"
                          src="{{productRecommend.images[0].imgUrl}}"
                          alt="img err">
                      </a>
                    </div>
                  </div>
                  <div class="product-grid__content">
                    <h3 class="product-grid__title">
                      <a
                        href="/product-details/{{productRecommend.id}}">
                        {{productRecommend.productName}}
                      </a>
                    </h3>
                    <div class="product-grid__prices">
                      <div class="product-prices">
                        <!-- <span style="color: red;margin-left: 10px;">-21%</span> -->
                        <!-- <del>239.000đ</del> -->
                        <ins>{{productRecommend.price | FormatVndPipe}} </ins>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- End  -->
    <!-- Phần mô tả -->
    <div class="product--decriptions" *ngIf="this.productType">
      <div class="dct--header">Chi tiết sản phẩm</div>
      <div class="dct--title"></div>
      <div class="info--box">
        {{this.productType.describe}}
      </div>
      <p><img style="display: block; margin-left: auto; margin-right: auto;"
          src="{{this.productType.image}}" alt=""
          width="550"></p>
          <h3 dir="ltr"><strong>Cách bảo quản&nbsp;</strong><strong>sản phẩm luôn bền bỉ</strong></h3>
          <blockquote>
            <ul>
            <li>Hạn chế dùng chất tẩy mạnh đối với áo và nên giặt bằng tay để đảm bảo độ bền của áo</li>
            <li dir="ltr">Không đổ trực tiếp bột giặt lên bề mặt áo vì nếu tác dụng tẩy mạnh sẽ làm chiếc áo nhanh bạc màu và ảnh hưởng đến chất liệu&nbsp;</li>
            <li dir="ltr">Nên hạn chế ngâm áo quá lâu trong bột giặt sẽ làm giảm tuổi thọ của chiếc áo</li>
            <li dir="ltr">Nên giặt bằng nước lạnh hoặc nước ấm (&lt;40 độ C) vì nếu giặt áo ở tình trạng nước quá nóng sẽ gây nên tình trạng áo bị giãn ra và nhanh hỏng hơn. Bạn có thể tham khảo thêm <a title="cách giặt áo polo nam" href="https://www.coolmate.me/post/cach-giat-ao-polo-nam" target="_blank" rel="noopener">cách giặt áo polo nam</a>.</li>
            </ul>
            </blockquote>
    </div>

    <!-- End -->
  </div>
</div>
<section id="reviews" class="product-single__reviews" *ngIf="ListReview">
  <div class="container">
    <div class="reviews">
      <div class="reviews__heading">
        <div class="reviews__title"><span class="reviews__count">{{ListReview.length}} Đánh giá</span> <span *ngIf="ListReview.length" class="reviews__ratings">{{formatRatingAvg(starAverage/ListReview.length)}}
            / 5</span></div>
      </div>
      <div class="reviews__filter">
        <div class="reviews__select"><select rel-script="reviews-filter-rating">
            <option value="">Đánh giá</option>
            <option value="1">1 sao</option>
            <option value="2">2 sao</option>
            <option value="3">3 sao</option>
            <option value="4">4 sao</option>
            <option value="5">5 sao</option>
          </select></div>
        <div class="reviews__select"><select rel-script="reviews-filter-image">
            <option value="">Ảnh</option>
            <option value="true">Có ảnh</option>
            <option value="false">Không ảnh</option>
          </select></div>
        <div class="reviews__select"><select rel-script="reviews-filter-replied">
            <option value="">Phản hồi</option>
            <option value="true">Đã phản hồi</option>
            <option value="false">Chưa phản hồi</option>
          </select></div>
      </div>
      <div class="reviews-listing" *ngIf="noData" >
        <div rel-script="product-reviews-listings" data-current-page="1" data-last-page="16" class="grid">
          <div class="grid__column six-twelfths mobile--one-whole">
            <div class="reviews-listing__item" *ngFor="let data of ListReview">
              <div class="reviews-listing__rating">
                <div class="reviews-rating">
                  <div class="reviews-rating__star is-active"*ngFor="let item of [1, 2, 3, 4,5].slice(0 , data.rating)"></div>
                </div>
              </div>
              <div class="reviews-listing__content">
                <div class="reviews-author">
                  <div class="reviews-author__name">
                    {{data.username}}
                  </div>
                </div>
                <div class="reviews-listing__description">
                  <p>
                    {{data.comment}}
                  </p>
                  <span class="reviews-listing__date">
                   {{data.createdDate | FormatDatePipe}}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</section>
<app-toast-message [isShowToast]="isShowToast" [result]="result" [product]="product"></app-toast-message>
